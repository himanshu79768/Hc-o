<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notification Test</title>
</head>
<body>
    <h1>Notification Test</h1>
    <button id="notifyBtn">Send Notification</button>
    <button id="backgroundBtn">Enable Background Notifications</button>

    <script>
        // Check if the browser supports notifications
        if (!("Notification" in window)) {
            alert("This browser does not support notifications");
        }

        // Request permission for notifications
        function requestNotificationPermission() {
            Notification.requestPermission().then(function (permission) {
                if (permission === "granted") {
                    console.log("Notification permission granted");
                }
            });
        }

        // Send a notification
        function sendNotification() {
            if (Notification.permission === "granted") {
                var notification = new Notification("Test Notification", {
                    body: "This is a test notification",
                    icon: "https://via.placeholder.com/64"
                });
            } else {
                requestNotificationPermission();
            }
        }

        // Enable background notifications
        function enableBackgroundNotifications() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('data:application/javascript;base64,' + btoa(`
                    self.addEventListener('install', function(event) {
                        console.log('Service Worker installed');
                    });

                    self.addEventListener('activate', function(event) {
                        console.log('Service Worker activated');
                    });

                    self.addEventListener('push', function(event) {
                        const options = {
                            body: 'This is a background notification',
                            icon: 'https://via.placeholder.com/64',
                            vibrate: [100, 50, 100],
                            data: {
                                dateOfArrival: Date.now(),
                                primaryKey: 1
                            }
                        };

                        event.waitUntil(
                            self.registration.showNotification('Background Notification', options)
                        );
                    });
                `))
                    .then(function(registration) {
                        console.log('Service Worker registered');
                    })
                    .catch(function(error) {
                        console.log('Service Worker registration failed:', error);
                    });
            }
        }

        // Event listeners
        document.getElementById("notifyBtn").addEventListener("click", sendNotification);
        document.getElementById("backgroundBtn").addEventListener("click", enableBackgroundNotifications);

        // Request permission on page load
        requestNotificationPermission();
    </script>
</body>
</html>
